{
  "id": "analytics-posthog-2025-01-03",
  "name": "posthog",
  "displayName": "PostHog Analytics",
  "description": "Open-source product analytics platform with event tracking, feature flags, session replay, and A/B testing capabilities for modern applications.",
  "type": "analytics",
  "provider": "posthog",
  "version": "1.0.0",
  "author": "PostHog",
  "license": "MIT",
  "homepage": "https://posthog.com",
  "repository": "https://github.com/PostHog/posthog-js",
  "keywords": ["analytics", "product-analytics", "feature-flags", "ab-testing", "session-replay"],
  "tags": ["enterprise", "saas", "open-source", "privacy-focused"],
  
  "frameworks": [
    {
      "name": "next",
      "versions": ["13.x", "14.x", "15.x"],
      "priority": 100
    },
    {
      "name": "react",
      "versions": ["17.x", "18.x", "19.x"],
      "priority": 90
    },
    {
      "name": "svelte",
      "versions": ["4.x", "5.x"],
      "priority": 80
    },
    {
      "name": "vue",
      "versions": ["3.x"],
      "priority": 75
    }
  ],
  
  "platforms": [
    {
      "name": "web",
      "architecture": ["x86_64", "arm64"],
      "os": ["linux", "darwin", "windows"]
    },
    {
      "name": "mobile",
      "os": ["ios", "android"]
    },
    {
      "name": "serverless",
      "cloud": {
        "providers": ["vercel", "netlify", "cloudflare"],
        "services": ["functions", "edge-runtime"]
      }
    }
  ],
  
  "runtimes": ["browser", "node", "react-native"],
  
  "injectionPoints": [
    {
      "path": "lib/posthog.ts",
      "type": "file",
      "strategy": "replace",
      "priority": 100,
      "templatePath": "analytics/posthog/client/posthog.ts.hbs"
    },
    {
      "path": "lib/posthog-server.ts",
      "type": "file",
      "strategy": "replace",
      "priority": 95,
      "templatePath": "analytics/posthog/server/posthog-server.ts.hbs"
    },
    {
      "path": "components/analytics/posthog-provider.tsx",
      "type": "file",
      "strategy": "replace",
      "priority": 90,
      "condition": "includes frameworks 'next' 'react'",
      "templatePath": "analytics/posthog/components/posthog-provider.tsx.hbs"
    },
    {
      "path": "hooks/use-posthog.ts",
      "type": "file",
      "strategy": "replace",
      "priority": 85,
      "condition": "includes frameworks 'next' 'react'",
      "templatePath": "analytics/posthog/hooks/use-posthog.ts.hbs"
    },
    {
      "path": "app/api/analytics/identify/route.ts",
      "type": "file",
      "strategy": "replace",
      "priority": 80,
      "condition": "eq framework 'next'",
      "templatePath": "analytics/posthog/next/identify-route.ts.hbs"
    },
    {
      "path": "app/api/analytics/track/route.ts",
      "type": "file",
      "strategy": "replace",
      "priority": 75,
      "condition": "eq framework 'next'",
      "templatePath": "analytics/posthog/next/track-route.ts.hbs"
    },
    {
      "path": "components/analytics/feature-flag.tsx",
      "type": "file",
      "strategy": "replace",
      "priority": 70,
      "condition": "and (includes frameworks 'next' 'react') config.enableFeatureFlags",
      "templatePath": "analytics/posthog/components/feature-flag.tsx.hbs"
    },
    {
      "path": "components/analytics/ab-test.tsx",
      "type": "file",
      "strategy": "replace",
      "priority": 65,
      "condition": "and (includes frameworks 'next' 'react') config.enableAbTesting",
      "templatePath": "analytics/posthog/components/ab-test.tsx.hbs"
    },
    {
      "path": ".env.local.example",
      "type": "env-file",
      "strategy": "append",
      "priority": 10,
      "templatePath": "analytics/posthog/env.hbs"
    }
  ],
  
  "envVariables": [
    {
      "name": "NEXT_PUBLIC_POSTHOG_KEY",
      "description": "PostHog public API key for client-side tracking",
      "required": true,
      "type": "string",
      "validation": {
        "pattern": "^phc_[a-zA-Z0-9_]+$"
      }
    },
    {
      "name": "NEXT_PUBLIC_POSTHOG_HOST",
      "description": "PostHog instance host URL",
      "required": false,
      "defaultValue": "https://app.posthog.com",
      "type": "url"
    },
    {
      "name": "POSTHOG_PERSONAL_API_KEY",
      "description": "PostHog personal API key for server-side operations",
      "required": false,
      "type": "secret",
      "sensitive": true
    },
    {
      "name": "POSTHOG_PROJECT_ID",
      "description": "PostHog project ID for API operations",
      "required": false,
      "type": "string"
    }
  ],
  
  "dependencies": [
    {
      "name": "posthog-js",
      "version": "^1.96.1",
      "type": "runtime",
      "reason": "PostHog JavaScript client for browser analytics"
    },
    {
      "name": "posthog-node",
      "version": "^3.6.3",
      "type": "runtime",
      "condition": "config.enableServerSide",
      "reason": "PostHog Node.js client for server-side analytics"
    },
    {
      "name": "posthog-react-native",
      "version": "^3.0.1",
      "type": "runtime",
      "condition": "eq platform 'react-native'",
      "reason": "PostHog React Native client"
    }
  ],
  
  "postInjectionSteps": [
    {
      "name": "install-dependencies",
      "command": "npm install",
      "description": "Install PostHog analytics dependencies",
      "timeout": 120000
    },
    {
      "name": "setup-posthog-project",
      "command": "echo 'Create your PostHog project at https://app.posthog.com'",
      "description": "Setup PostHog project and get API keys"
    },
    {
      "name": "verify-posthog-connection",
      "command": "node -e \"const posthog = require('posthog-node'); const client = new posthog.PostHog(process.env.NEXT_PUBLIC_POSTHOG_KEY, { host: process.env.NEXT_PUBLIC_POSTHOG_HOST }); client.capture({ distinctId: 'test', event: 'setup_verification' }); console.log('PostHog connection verified'); client.shutdown();\"",
      "description": "Verify PostHog connection",
      "condition": "env.NEXT_PUBLIC_POSTHOG_KEY",
      "timeout": 30000
    }
  ],
  
  "requirements": {
    "node": {
      "min": "16.0.0",
      "lts": true
    },
    "memory": {
      "min": "128MB",
      "recommended": "256MB"
    },
    "network": {
      "internet": true,
      "ports": [443]
    }
  },
  
  "multiTenant": true,
  "compliance": ["gdpr", "ccpa", "hipaa"],
  
  "scalingRequirements": {
    "horizontal": true,
    "vertical": true,
    "stateless": true
  },
  
  "category": "analytics",
  "subcategory": "product-analytics",
  "maturity": "stable",
  "supportLevel": "commercial",
  
  "configSchema": {
    "type": "object",
    "properties": {
      "enableServerSide": {
        "type": "boolean",
        "default": true,
        "description": "Enable server-side tracking"
      },
      "enableFeatureFlags": {
        "type": "boolean",
        "default": true,
        "description": "Enable feature flags functionality"
      },
      "enableAbTesting": {
        "type": "boolean",
        "default": false,
        "description": "Enable A/B testing capabilities"
      },
      "enableSessionReplay": {
        "type": "boolean",
        "default": false,
        "description": "Enable session replay recording"
      },
      "enableHeatmaps": {
        "type": "boolean",
        "default": false,
        "description": "Enable heatmaps and click tracking"
      },
      "capturePageViews": {
        "type": "boolean",
        "default": true,
        "description": "Automatically capture page views"
      },
      "captureClicks": {
        "type": "boolean",
        "default": true,
        "description": "Automatically capture click events"
      },
      "enableConsoleLogging": {
        "type": "boolean",
        "default": false,
        "description": "Enable console logging for debugging"
      },
      "respectDoNotTrack": {
        "type": "boolean",
        "default": true,
        "description": "Respect Do Not Track browser setting"
      },
      "enableGdprMode": {
        "type": "boolean",
        "default": false,
        "description": "Enable GDPR compliance mode"
      },
      "cookieDomain": {
        "type": "string",
        "description": "Custom cookie domain for tracking"
      },
      "sessionRecordingVersion": {
        "type": "string",
        "default": "v1",
        "enum": ["v1", "v2"],
        "description": "Session recording version to use"
      }
    }
  },
  
  "defaultConfig": {
    "enableServerSide": true,
    "enableFeatureFlags": true,
    "enableAbTesting": false,
    "enableSessionReplay": false,
    "enableHeatmaps": false,
    "capturePageViews": true,
    "captureClicks": true,
    "enableConsoleLogging": false,
    "respectDoNotTrack": true,
    "enableGdprMode": false,
    "sessionRecordingVersion": "v1"
  },
  
  "examples": [
    {
      "name": "basic-analytics",
      "description": "Basic product analytics setup",
      "config": {
        "enableServerSide": true,
        "enableFeatureFlags": true,
        "capturePageViews": true
      }
    },
    {
      "name": "full-analytics",
      "description": "Comprehensive analytics with all features",
      "config": {
        "enableServerSide": true,
        "enableFeatureFlags": true,
        "enableAbTesting": true,
        "enableSessionReplay": true,
        "enableHeatmaps": true
      }
    },
    {
      "name": "gdpr-compliant",
      "description": "GDPR-compliant analytics setup",
      "config": {
        "enableGdprMode": true,
        "respectDoNotTrack": true,
        "enableSessionReplay": false,
        "captureClicks": false
      }
    }
  ],
  
  "testing": {
    "unit": {
      "framework": "jest",
      "testPaths": ["__tests__/analytics"]
    },
    "integration": {
      "framework": "playwright",
      "services": ["posthog-test-mode"]
    }
  },
  
  "security": {
    "vulnerabilityScanning": {
      "enabled": true,
      "tools": ["npm-audit"]
    },
    "secretScanning": {
      "enabled": true,
      "patterns": ["POSTHOG_PERSONAL_API_KEY"]
    }
  },
  
  "compliance": {
    "standards": ["gdpr", "ccpa", "hipaa"],
    "dataHandling": {
      "personalData": true,
      "encryption": true,
      "audit": true
    },
    "accessibility": {
      "wcag": "AA",
      "testing": true
    }
  },
  
  "createdAt": "2025-01-03T00:00:00.000Z",
  "updatedAt": "2025-01-03T00:00:00.000Z",
  "createdBy": "backend-expert-agent"
}